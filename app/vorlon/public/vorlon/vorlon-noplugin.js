!function(e){"use strict";var t=function(){this.cssImportStatements=[],this.cssKeyframeStatements=[],this.cssRegex=new RegExp("([\\s\\S]*?){([\\s\\S]*?)}","gi"),this.cssMediaQueryRegex="((@media [\\s\\S]*?){([\\s\\S]*?}\\s*?)})",this.cssKeyframeRegex="((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})",this.combinedCSSRegex="((\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",this.cssCommentsRegex="(\\/\\*[\\s\\S]*?\\*\\/)",this.cssImportStatementRegex=new RegExp("@import .*?;","gi")};t.prototype.stripComments=function(e){var t=new RegExp(this.cssCommentsRegex,"gi");return e.replace(t,"")},t.prototype.parseCSS=function(e){if(void 0===e)return[];for(var t=[];;){var o=this.cssImportStatementRegex.exec(e);if(null===o)break;this.cssImportStatements.push(o[0]),t.push({selector:"@imports",type:"imports",styles:o[0]})}e=e.replace(this.cssImportStatementRegex,"");for(var n,r=new RegExp(this.cssKeyframeRegex,"gi");;){if(n=r.exec(e),null===n)break;t.push({selector:"@keyframes",type:"keyframes",styles:n[0]})}e=e.replace(r,"");for(var i=new RegExp(this.combinedCSSRegex,"gi");;){if(n=i.exec(e),null===n)break;var s="";s=void 0===n[2]?n[5].split("\r\n").join("\n").trim():n[2].split("\r\n").join("\n").trim();var a=new RegExp(this.cssCommentsRegex,"gi"),l=a.exec(s);if(null!==l&&(s=s.replace(a,"").trim()),-1!==s.indexOf("@media")){var c={selector:s,type:"media",subStyles:this.parseCSS(n[3]+"\n}")};null!==l&&(c.comments=l[0]),t.push(c)}else{var d=this.parseRules(n[6]),u={selector:s,rules:d};"@font-face"===s&&(u.type="font-face"),null!==l&&(u.comments=l[0]),t.push(u)}}return t},t.prototype.parseRules=function(e){e=e.split("\r\n").join("\n");var t=[];e=e.split(";");for(var o=0;o<e.length;o++){var n=e[o];if(n=n.trim(),-1!==n.indexOf(":")){n=n.split(":");var r=n[0].trim(),i=n.slice(1).join(":").trim();if(r.length<1||i.length<1)continue;t.push({directive:r,value:i})}else"base64,"==n.trim().substr(0,7)?t[t.length-1].value+=n.trim():n.length>0&&t.push({directive:"",value:n,defective:!0})}return t},t.prototype.findCorrespondingRule=function(e,t,o){void 0===o&&(o=!1);for(var n=!1,r=0;r<e.length&&(e[r].directive!=t||(n=e[r],o!==e[r].value));r++);return n},t.prototype.findBySelector=function(e,t,o){void 0===o&&(o=!1);for(var n=[],r=0;r<e.length;r++)o===!1?e[r].selector===t&&n.push(e[r]):-1!==e[r].selector.indexOf(t)&&n.push(e[r]);if(n.length<2)return n;var i=n[0];for(r=1;r<n.length;r++)this.intelligentCSSPush([i],n[r]);return[i]},t.prototype.deleteBySelector=function(e,t){for(var o=[],n=0;n<e.length;n++)e[n].selector!==t&&o.push(e[n]);return o},t.prototype.compressCSS=function(e){for(var t=[],o={},n=0;n<e.length;n++){var r=e[n];if(o[r.selector]!==!0){var i=this.findBySelector(e,r.selector);0!==i.length&&(t.push(i[0]),o[r.selector]=!0)}}return t},t.prototype.cssDiff=function(e,t){if(e.selector!==t.selector)return!1;if("media"===e.type||"media"===t.type)return!1;for(var o,n,r={selector:e.selector,rules:[]},i=0;i<e.rules.length;i++)o=e.rules[i],n=this.findCorrespondingRule(t.rules,o.directive,o.value),n===!1?r.rules.push(o):o.value!==n.value&&r.rules.push(o);for(var s=0;s<t.rules.length;s++)n=t.rules[s],o=this.findCorrespondingRule(e.rules,n.directive),o===!1&&(n.type="DELETED",r.rules.push(n));return 0===r.rules.length?!1:r},t.prototype.intelligentMerge=function(e,t,o){void 0===o&&(o=!1);for(var n=0;n<t.length;n++)this.intelligentCSSPush(e,t[n],o);for(n=0;n<e.length;n++){var r=e[n];"media"!==r.type&&"keyframes"!==r.type&&(r.rules=this.compactRules(r.rules))}},t.prototype.intelligentCSSPush=function(e,t,o){var n=(t.selector,!1);if(void 0===o&&(o=!1),o===!1){for(var r=0;r<e.length;r++)if(e[r].selector===t.selector){n=e[r];break}}else for(var i=e.length-1;i>-1;i--)if(e[i].selector===t.selector){n=e[i];break}if(n===!1)e.push(t);else if("media"!==t.type)for(var s=0;s<t.rules.length;s++){var a=t.rules[s],l=this.findCorrespondingRule(n.rules,a.directive);l===!1?n.rules.push(a):"DELETED"==a.type?l.type="DELETED":l.value=a.value}else n.subStyles=t.subStyles},t.prototype.compactRules=function(e){for(var t=[],o=0;o<e.length;o++)"DELETED"!==e[o].type&&t.push(e[o]);return t},t.prototype.getCSSForEditor=function(e,t){void 0===t&&(t=0);var o="";void 0===e&&(e=this.css);for(var n=0;n<e.length;n++)"imports"==e[n].type&&(o+=e[n].styles+"\n\n");for(n=0;n<e.length;n++){var r=e[n];if(void 0!==r.selector){var i="";void 0!==r.comments&&(i=r.comments+"\n"),"media"==r.type?(o+=i+r.selector+"{\n",o+=this.getCSSForEditor(r.subStyles,t+1),o+="}\n\n"):"keyframes"!==r.type&&"imports"!==r.type&&(o+=this.getSpaces(t)+i+r.selector+" {\n",o+=this.getCSSOfRules(r.rules,t+1),o+=this.getSpaces(t)+"}\n\n")}}for(n=0;n<e.length;n++)"keyframes"==e[n].type&&(o+=e[n].styles+"\n\n");return o},t.prototype.getImports=function(e){for(var t=[],o=0;o<e.length;o++)"imports"==e[o].type&&t.push(e[o].styles);return t},t.prototype.getCSSOfRules=function(e,t){for(var o="",n=0;n<e.length;n++)void 0!==e[n]&&(o+=void 0===e[n].defective?this.getSpaces(t)+e[n].directive+" : "+e[n].value+";\n":this.getSpaces(t)+e[n].value+";\n");return o||"\n"},t.prototype.getSpaces=function(e){for(var t="",o=0;4*e>o;o++)t+=" ";return t},t.prototype.applyNamespacing=function(e,t){var o=e,n="."+this.cssPreviewNamespace;void 0!==t&&(n=t),"string"==typeof e&&(o=this.parseCSS(e));for(var r=0;r<o.length;r++){var i=o[r];if(!(i.selector.indexOf("@font-face")>-1||i.selector.indexOf("keyframes")>-1||i.selector.indexOf("@import")>-1||i.selector.indexOf(".form-all")>-1||i.selector.indexOf("#stage")>-1))if("media"!==i.type){for(var s=i.selector.split(","),a=[],l=0;l<s.length;l++)-1===s[l].indexOf(".supernova")?a.push(n+" "+s[l]):a.push(s[l]);i.selector=a.join(",")}else i.subStyles=this.applyNamespacing(i.subStyles,t)}return o},t.prototype.clearNamespacing=function(e,t){void 0===t&&(t=!1);var o=e,n="."+this.cssPreviewNamespace;"string"==typeof e&&(o=this.parseCSS(e));for(var r=0;r<o.length;r++){var i=o[r];if("media"!==i.type){for(var s=i.selector.split(","),a=[],l=0;l<s.length;l++)a.push(s[l].split(n+" ").join(""));i.selector=a.join(",")}else i.subStyles=this.clearNamespacing(i.subStyles,!0)}return t===!1?this.getCSSForEditor(o):o},t.prototype.createStyleElement=function(e,t,o){if(void 0===o&&(o=!1),this.testMode===!1&&"nonamespace"!==o&&(t=this.applyNamespacing(t)),"string"!=typeof t&&(t=this.getCSSForEditor(t)),o===!0&&(t=this.getCSSForEditor(this.parseCSS(t))),this.testMode!==!1)return this.testMode("create style #"+e,t);var n=document.getElementById(e);n&&n.parentNode.removeChild(n);var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.id=e,i.type="text/css",r.appendChild(i),i.styleSheet&&!i.sheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))},e.cssjs=t}(this);var VORLON;!function(e){var t=function(){function t(){}return t.QuerySelectorById=function(e,t){return e.querySelector?e.querySelector("#"+t):document.getElementById(t)},t.SetImmediate=function(e){window.setImmediate?setImmediate(e):setTimeout(e,0)},t.setLocalStorageValue=function(e,t){if(localStorage)try{localStorage.setItem(e,t)}catch(o){}},t.getLocalStorageValue=function(e){if(localStorage)try{return localStorage.getItem(e)}catch(t){return""}},t.Hook=function(e,t,o){var n=e[t];return e[t]=function(){for(var t=[],r=0;r<arguments.length;r++)t[r-0]=arguments[r];o(t),n.apply(e,t)},n},t.HookProperty=function(t,o,n){var r=t[o];Object.defineProperty(t,o,{get:function(){return n&&n(e.Tools.getCallStack(1)),r}})},t.getCallStack=function(e){e=e||0;try{throw new Error}catch(t){for(var o=t.stack.split("\n"),n=0,r=2+e,i=o.length;i>r;r++)if(o[r].indexOf("http://")>=0){n=r;break}var s={stack:t.stack},a=o[n],l=a.indexOf("http://")||a.indexOf("https://");if(l>0){var c=a.indexOf(")",l);0>c&&(c=a.length-1);var d=a.substr(l,c-l),u=d.indexOf(":",d.lastIndexOf("/"));s.file=d.substr(0,u)}return s}},t.CreateCookie=function(e,t,o){var n;if(o){var r=new Date;r.setTime(r.getTime()+24*o*60*60*1e3),n="; expires="+r.toUTCString()}else n="";document.cookie=e+"="+t+n+"; path=/"},t.ReadCookie=function(e){for(var t=e+"=",o=document.cookie.split(";"),n=0;n<o.length;n++){for(var r=o[n];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return""},t.CreateGUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,o="x"===e?t:3&t|8;return o.toString(16)})},t.RemoveEmpties=function(e){for(var t=e.length,o=t-1;o>=0;o--)e[o]||(e.splice(o,1),t--);return t},t.AddClass=function(e,o){if(e.classList){if(o.indexOf(" ")<0)e.classList.add(o);else{var n=o.split(" ");t.RemoveEmpties(n);for(var r=0,i=n.length;i>r;r++)e.classList.add(n[r])}return e}var s,a=e.className,l=a.split(" "),c=t.RemoveEmpties(l);if(o.indexOf(" ")>=0){for(n=o.split(" "),t.RemoveEmpties(n),r=0;c>r;r++){var d=n.indexOf(l[r]);d>=0&&n.splice(d,1)}n.length>0&&(s=n.join(" "))}else{var u=!1;for(r=0;c>r;r++)if(l[r]===o){u=!0;break}u||(s=o)}return s&&(e.className=c>0&&l[0].length>0?a+" "+s:s),e},t.RemoveClass=function(e,o){if(e.classList){if(0===e.classList.length)return e;var n=o.split(" ");t.RemoveEmpties(n);for(var r=0,i=n.length;i>r;r++)e.classList.remove(n[r]);return e}var s=e.className;if(o.indexOf(" ")>=0)n=o.split(" "),t.RemoveEmpties(n);else{if(s.indexOf(o)<0)return e;n=[o]}var a,l=s.split(" "),c=t.RemoveEmpties(l);for(r=c-1;r>=0;r--)n.indexOf(l[r])>=0&&(l.splice(r,1),a=!0);return a&&(e.className=l.join(" ")),e},t.ToggleClass=function(e,o,n){e.className.match(o)?(t.RemoveClass(e,o),n&&n(!1)):(t.AddClass(e,o),n&&n(!0))},t.htmlToString=function(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;")},t}();e.Tools=t;var o=function(){function e(e,t,o,n){this.childs=[],e&&(this.element=document.createElement(e),t&&(this.element.className=t),o&&o.appendChild(this.element),this.parent=n,n&&n.childs.push(this))}return e.forElement=function(t){var o=new e(null);return o.element=t,o},e.prototype.addClass=function(e){return this.element.classList.add(e),this},e.prototype.toggleClass=function(e){return this.element.classList.toggle(e),this},e.prototype.className=function(e){return this.element.className=e,this},e.prototype.opacity=function(e){return this.element.style.opacity=e,this},e.prototype.display=function(e){return this.element.style.display=e,this},e.prototype.hide=function(){return this.element.style.display="none",this},e.prototype.visibility=function(e){return this.element.style.visibility=e,this},e.prototype.text=function(e){return this.element.textContent=e,this},e.prototype.html=function(e){return this.element.innerHTML=e,this},e.prototype.attr=function(e,t){return this.element.setAttribute(e,t),this},e.prototype.editable=function(e){return this.element.contentEditable=e?"true":"false",this},e.prototype.style=function(e,t){return this.element.style[e]=t,this},e.prototype.appendTo=function(e){return e.appendChild(this.element),this},e.prototype.append=function(t,o,n){var r=new e(t,o,this.element,this);return n&&n(r),this},e.prototype.createChild=function(t,o){var n=new e(t,o,this.element,this);return n},e.prototype.click=function(e){return this.element.addEventListener("click",e),this},e.prototype.blur=function(e){return this.element.addEventListener("blur",e),this},e.prototype.keydown=function(e){return this.element.addEventListener("keydown",e),this},e}();e.FluentDOM=o}(VORLON||(VORLON={}));var VORLON;!function(e){!function(e){e[e.Client=0]="Client",e[e.Dashboard=1]="Dashboard",e[e.Both=2]="Both"}(e.RuntimeSide||(e.RuntimeSide={}));e.RuntimeSide;!function(e){e[e.OneOne=0]="OneOne",e[e.MulticastReceiveOnly=1]="MulticastReceiveOnly",e[e.Multicast=2]="Multicast"}(e.PluginType||(e.PluginType={}));e.PluginType}(VORLON||(VORLON={}));var VORLON;!function(e){var t=function(){function t(t){this.name=t,this._ready=!0,this._id="",this._type=e.PluginType.OneOne,this.traceLog=function(e){console.log(e)},this.traceNoop=function(){},this.loadingDirectory="vorlon/plugins",this.debug=e.Core.debug}return Object.defineProperty(t.prototype,"Type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"debug",{get:function(){return this._debug},set:function(e){this._debug=e,this.trace=e?this.traceLog:this.traceNoop},enumerable:!0,configurable:!0}),t.prototype.getID=function(){return this._id},t.prototype.isReady=function(){return this._ready},t}();e.BasePlugin=t}(VORLON||(VORLON={}));var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},VORLON;!function(e){var t=function(t){function o(e){t.call(this,e)}return __extends(o,t),o.prototype.startClientSide=function(){},o.prototype.onRealtimeMessageReceivedFromDashboardSide=function(){},o.prototype.sendToDashboard=function(t){e.Core.Messenger&&e.Core.Messenger.sendRealtimeMessage(this.getID(),t,e.RuntimeSide.Client,"message")},o.prototype.sendCommandToDashboard=function(t,o){void 0===o&&(o=null),e.Core.Messenger&&(this.trace(this.getID()+" send command to dashboard "+t),e.Core.Messenger.sendRealtimeMessage(this.getID(),o,e.RuntimeSide.Client,"message",t))},o.prototype.refresh=function(){console.error("Please override plugin.refresh()")},o.prototype._loadNewScriptAsync=function(e,t,o){function n(){var o=document.createElement("script");o.setAttribute("src",i+e),o.onload=t;var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(o,n)}var r=this,i="";i=0===this.loadingDirectory.indexOf("http")?this.loadingDirectory+"/"+this.name+"/":vorlonBaseURL+"/"+this.loadingDirectory+"/"+this.name+"/",!o||document.body?n():document.addEventListener("DOMContentLoaded",function(){r._loadNewScriptAsync(e,t,o)})},o}(e.BasePlugin);e.ClientPlugin=t}(VORLON||(VORLON={}));var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);o.prototype=t.prototype,e.prototype=new o},VORLON;!function(e){var t=function(t){function o(o,n,r){t.call(this,o),this.htmlFragmentUrl=n,this.cssStyleSheetUrl=r,this.debug=e.Core.debug}return __extends(o,t),o.prototype.startDashboardSide=function(){},o.prototype.onRealtimeMessageReceivedFromClientSide=function(){},o.prototype.sendToClient=function(t){e.Core.Messenger&&e.Core.Messenger.sendRealtimeMessage(this.getID(),t,e.RuntimeSide.Dashboard,"message")},o.prototype.sendCommandToClient=function(t,o){void 0===o&&(o=null),e.Core.Messenger&&(this.trace(this.getID()+" send command to client "+t),e.Core.Messenger.sendRealtimeMessage(this.getID(),o,e.RuntimeSide.Dashboard,"message",t))},o.prototype.sendCommandToPluginClient=function(t,o,n){void 0===n&&(n=null),e.Core.Messenger&&(this.trace(this.getID()+" send command to plugin client "+o),e.Core.Messenger.sendRealtimeMessage(t,n,e.RuntimeSide.Dashboard,"protocol",o))},o.prototype.sendCommandToPluginDashboard=function(t,o,n){void 0===n&&(n=null),e.Core.Messenger&&(this.trace(this.getID()+" send command to plugin dashboard "+o),e.Core.Messenger.sendRealtimeMessage(t,n,e.RuntimeSide.Client,"protocol",o))},o.prototype._insertHtmlContentAsync=function(e,t){var o=this,n=vorlonBaseURL+"/"+this.loadingDirectory+"/"+this.name+"/",r=!1;e||(e=document.createElement("div"),document.body.appendChild(e),r=!0);var i=new XMLHttpRequest;i.open("GET",n+this.htmlFragmentUrl,!0),i.onreadystatechange=function(){if(4===i.readyState){if(200!==i.status)throw new Error("Error status: "+i.status+" - Unable to load "+n+o.htmlFragmentUrl);e.innerHTML=o._stripContent(i.responseText);var s=document.getElementsByTagName("head")[0],a=document.createElement("link");a.type="text/css",a.rel="stylesheet",a.href=n+o.cssStyleSheetUrl,a.media="screen",s.appendChild(a);var l=e.children[0];r&&(l.className="alone"),t(l)}},i.send(null)},o.prototype._stripContent=function(e){var t=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,o=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im;if(e){e=e.replace(t,"");var n=e.match(o);n&&(e=n[1])}return e},o}(e.BasePlugin);e.DashboardPlugin=t}(VORLON||(VORLON={}));var VORLON;!function(e){var t=function(){function t(t,o,n,r,i){var s=this;switch(this._isConnected=!1,this._isConnected=!1,this._sessionId=n,this._clientId=r,e.Core._listenClientId=i,this._serverUrl=o,t){case e.RuntimeSide.Client:this._socket=io.connect(o),this._isConnected=!0;break;case e.RuntimeSide.Dashboard:this._socket=io.connect(o+"/dashboard"),this._isConnected=!0}if(this.isConnected){var a=io.Manager(o);a.on("connect_error",function(e){s.onError&&s.onError(e)}),this._socket.on("message",function(e){var t=JSON.parse(e);s.onRealtimeMessageReceived&&s.onRealtimeMessageReceived(t)}),this._socket.on("helo",function(t){e.Core._listenClientId=t,s.onHeloReceived&&s.onHeloReceived(t)}),this._socket.on("identify",function(e){s.onIdentifyReceived&&s.onIdentifyReceived(e)}),this._socket.on("stoplisten",function(){s.onStopListenReceived&&s.onStopListenReceived()}),this._socket.on("refreshclients",function(){s.onRefreshClients&&s.onRefreshClients()}),this._socket.on("addclient",function(e){s.onAddClient&&s.onAddClient(e)}),this._socket.on("removeclient",function(e){s.onRemoveClient&&s.onRemoveClient(e)}),this._socket.on("reload",function(t){e.Core._listenClientId=t,s.onReload&&s.onReload(t)})}}return Object.defineProperty(t.prototype,"isConnected",{get:function(){return this._isConnected},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clientId",{set:function(e){this._clientId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"socketId",{get:function(){return this._socket.id},enumerable:!0,configurable:!0}),t.prototype.stopListening=function(){this._socket&&this._socket.removeAllListeners()},t.prototype.sendRealtimeMessage=function(t,o,n,r,i){void 0===r&&(r="message");var s={metadata:{pluginID:t,side:n,sessionId:this._sessionId,clientId:this._clientId,listenClientId:e.Core._listenClientId},data:o};if(i&&(s.command=i),!this.isConnected)return this.onRealtimeMessageReceived&&this.onRealtimeMessageReceived(s),void 0;if(""!==e.Core._listenClientId||"message"!==r){var a=JSON.stringify(s);this._socket.emit(r,a)}},t.prototype.sendMonitoringMessage=function(e,t){var o=new XMLHttpRequest;o.onreadystatechange=function(){4===o.readyState&&200===o.status},o.open("POST",this._serverUrl+"api/push"),o.setRequestHeader("Content-type","application/json;charset=UTF-8");var n=JSON.stringify({_idsession:this._sessionId,id:e,message:t});o.send(n)},t.prototype.getMonitoringMessage=function(e,t,o,n){void 0===o&&(o="-20"),void 0===n&&(n="-1");var r=new XMLHttpRequest;r.onreadystatechange=function(){4===r.readyState?200===r.status?t&&t(JSON.parse(r.responseText)):t&&t(null):t&&t(null)},r.open("GET",this._serverUrl+"api/range/"+this._sessionId+"/"+e+"/"+o+"/"+n),r.send()},t}();e.ClientMessenger=t}(VORLON||(VORLON={}));var VORLON;!function(e){var t=function(){function t(){this._clientPlugins=new Array,this._dashboardPlugins=new Array,this._socketIOWaitCount=0,this.debug=!1,this._RetryTimeout=1002}return Object.defineProperty(t.prototype,"Messenger",{get:function(){return e.Core._messenger},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ClientPlugins",{get:function(){return e.Core._clientPlugins},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DashboardPlugins",{get:function(){return e.Core._dashboardPlugins},enumerable:!0,configurable:!0}),t.prototype.RegisterClientPlugin=function(t){e.Core._clientPlugins.push(t)},t.prototype.RegisterDashboardPlugin=function(t){e.Core._dashboardPlugins.push(t)},t.prototype.StopListening=function(){e.Core._messenger&&(e.Core._messenger.stopListening(),delete e.Core._messenger)},t.prototype.StartClientSide=function(t,o,n){var r=this;if(void 0===t&&(t="'http://localhost:1337/'"),void 0===o&&(o=""),void 0===n&&(n=""),e.Core._side=e.RuntimeSide.Client,e.Core._sessionID=o,e.Core._listenClientId=n,void 0===window.io)return this._socketIOWaitCount<10?(this._socketIOWaitCount++,setTimeout(function(){console.log("Vorlon.js: waiting for socket.io to load..."),e.Core.StartClientSide(t,o,n)},1e3)):(console.log("Vorlon.js: please load socket.io before referencing vorlon.js or use includeSocketIO = true in your catalog.json file."),e.Core.ShowError("Vorlon.js: please load socket.io before referencing vorlon.js or use includeSocketIO = true in your catalog.json file.",0)),void 0;var i=e.Tools.ReadCookie("vorlonJS_clientId");i||(i=e.Tools.CreateGUID(),e.Tools.CreateCookie("vorlonJS_clientId",i,1)),e.Core._messenger&&(e.Core._messenger.stopListening(),delete e.Core._messenger),e.Core._messenger=new e.ClientMessenger(e.Core._side,t,o,i,n),e.Core.Messenger.onRealtimeMessageReceived=e.Core._Dispatch,e.Core.Messenger.onHeloReceived=e.Core._OnIdentificationReceived,e.Core.Messenger.onIdentifyReceived=e.Core._OnIdentifyReceived,e.Core.Messenger.onStopListenReceived=e.Core._OnStopListenReceived,e.Core.Messenger.onError=e.Core._OnError,e.Core.Messenger.onReload=e.Core._OnReloadClient;var s={ua:navigator.userAgent};e.Core.Messenger.sendRealtimeMessage("",s,e.Core._side,"helo");for(var a=0;a<e.Core._clientPlugins.length;a++){var l=e.Core._clientPlugins[a];l.startClientSide()}window.addEventListener("beforeunload",function(){e.Core.Messenger.sendRealtimeMessage("",{socketid:e.Core.Messenger.socketId},e.Core._side,"clientclosed")},!1),setTimeout(function(){r.startClientDirtyCheck()},500)},t.prototype.startClientDirtyCheck=function(){var t=this;if(!document.body)return setTimeout(function(){t.startClientDirtyCheck()},200),void 0;var o=window.MutationObserver||window.WebKitMutationObserver||null;if(o){document.body.__vorlon||(document.body.__vorlon={});var n={attributes:!0,childList:!0,subtree:!0,characterData:!0};document.body.__vorlon._observerMutationObserver=new o(function(t){var o=!1,n=!1,r=[];t.forEach(function(t){if(n){for(var i=0;i<r.length;i++)clearTimeout(r[i]);n=!1}return t.target&&t.target.__vorlon&&t.target.__vorlon.ignore?(n=!0,void 0):t.previousSibling&&t.previousSibling.__vorlon&&t.previousSibling.__vorlon.ignore?(n=!0,void 0):(t.target&&!o&&t.target.__vorlon&&t.target.parentNode&&t.target.parentNode.__vorlon&&t.target.parentNode.__vorlon.internalId&&r.push(setTimeout(function(){var o=null;t&&t.target&&t.target.parentNode&&t.target.parentNode.__vorlon&&t.target.parentNode.__vorlon.internalId&&(o=t.target.parentNode.__vorlon.internalId),e.Core.Messenger.sendRealtimeMessage("ALL_PLUGINS",{type:"contentchanged",internalId:o},e.Core._side,"message")},300)),o=!0,void 0)})}),document.body.__vorlon._observerMutationObserver.observe(document.body,n)}else{console.log("dirty check using html string");var r;document.body&&(r=document.body.innerHTML),setInterval(function(){var t=document.body.innerHTML;r!=t&&(r=t,e.Core.Messenger.sendRealtimeMessage("ALL_PLUGINS",{type:"contentchanged"},e.Core._side,"message"))},2e3)}},t.prototype.StartDashboardSide=function(t,o,n,r){if(void 0===t&&(t="'http://localhost:1337/'"),void 0===o&&(o=""),void 0===n&&(n=""),void 0===r&&(r=null),e.Core._side=e.RuntimeSide.Dashboard,e.Core._sessionID=o,e.Core._listenClientId=n,e.Core._errorNotifier=document.createElement("x-notify"),e.Core._errorNotifier.setAttribute("type","error"),e.Core._errorNotifier.setAttribute("position","top"),e.Core._errorNotifier.setAttribute("duration",5e3),e.Core._messageNotifier=document.createElement("x-notify"),e.Core._messageNotifier.setAttribute("position","top"),e.Core._messageNotifier.setAttribute("duration",4e3),document.body.appendChild(e.Core._errorNotifier),document.body.appendChild(e.Core._messageNotifier),void 0===window.io)return this._socketIOWaitCount<10?(this._socketIOWaitCount++,setTimeout(function(){console.log("Vorlon.js: waiting for socket.io to load..."),e.Core.StartDashboardSide(t,o,n,r)},1e3)):(console.log("Vorlon.js: please load socket.io before referencing vorlon.js or use includeSocketIO = true in your catalog.json file."),e.Core.ShowError("Vorlon.js: please load socket.io before referencing vorlon.js or use includeSocketIO = true in your catalog.json file.",0)),void 0;var i=e.Tools.ReadCookie("vorlonJS_clientId");i||(i=e.Tools.CreateGUID(),e.Tools.CreateCookie("vorlonJS_clientId",i,1)),e.Core._messenger&&(e.Core._messenger.stopListening(),delete e.Core._messenger),e.Core._messenger=new e.ClientMessenger(e.Core._side,t,o,i,n),e.Core.Messenger.onRealtimeMessageReceived=e.Core._Dispatch,e.Core.Messenger.onHeloReceived=e.Core._OnIdentificationReceived,e.Core.Messenger.onIdentifyReceived=e.Core._OnIdentifyReceived,e.Core.Messenger.onStopListenReceived=e.Core._OnStopListenReceived,e.Core.Messenger.onError=e.Core._OnError;var s={ua:navigator.userAgent};e.Core.Messenger.sendRealtimeMessage("",s,e.Core._side,"helo");for(var a=0;a<e.Core._dashboardPlugins.length;a++){var l=e.Core._dashboardPlugins[a];l.startDashboardSide(r?r(l.getID()):null)}},t.prototype._OnStopListenReceived=function(){e.Core._listenClientId=""},t.prototype._OnIdentifyReceived=function(t){if(e.Core._side===e.RuntimeSide.Dashboard)e.Core._messageNotifier.innerHTML=t,e.Core._messageNotifier.show();else{var o=document.createElement("div");o.className="vorlonIdentifyNumber",o.style.position="absolute",o.style.left="0",o.style.top="50%",o.style.marginTop="-150px",o.style.width="100%",o.style.height="300px",o.style.fontFamily="Arial",o.style.fontSize="300px",o.style.textAlign="center",o.style.color="white",o.style.textShadow="2px 2px 5px black",o.style.zIndex="100",o.innerHTML=t,document.body.appendChild(o),setTimeout(function(){document.body.removeChild(o)},4e3)}},t.prototype.ShowError=function(t,o){if(void 0===o&&(o=5e3),e.Core._side===e.RuntimeSide.Dashboard)e.Core._errorNotifier.innerHTML=t,e.Core._errorNotifier.setAttribute("duration",o),e.Core._errorNotifier.show();else{var n=document.createElement("div");n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.width="100%",n.style.height="100px",n.style.backgroundColor="red",n.style.textAlign="center",n.style.fontSize="30px",n.style.paddingTop="20px",n.style.color="white",n.style.fontFamily="consolas",n.style.zIndex="1001",n.innerHTML=t,document.body.appendChild(n),o&&setTimeout(function(){document.body.removeChild(n)},o)}},t.prototype._OnError=function(t){e.Core.ShowError("Error while connecting to server. Server may be offline.<BR>Error message: "+t.message)},t.prototype._OnIdentificationReceived=function(t){if(e.Core._listenClientId=t,e.Core._side===e.RuntimeSide.Client)for(var o=0;o<e.Core._clientPlugins.length;o++){var n=e.Core._clientPlugins[o];n.refresh()}else{var r=document.querySelector(".dashboard-plugins-overlay");e.Tools.AddClass(r,"hidden"),e.Tools.RemoveClass(r,"bounce"),document.getElementById("test").style.visibility="visible"}},t.prototype._OnReloadClient=function(){document.location.reload()},t.prototype._RetrySendingRealtimeMessage=function(t,o){setTimeout(function(){return t.isReady()?(e.Core._DispatchFromClientPluginMessage(t,o),void 0):(e.Core._RetrySendingRealtimeMessage(t,o),void 0)},e.Core._RetryTimeout)},t.prototype._Dispatch=function(t){return t.metadata?("ALL_PLUGINS"==t.metadata.pluginID?(e.Core._clientPlugins.forEach(function(o){e.Core._DispatchPluginMessage(o,t)}),e.Core._dashboardPlugins.forEach(function(o){e.Core._DispatchPluginMessage(o,t)})):(e.Core._clientPlugins.forEach(function(o){return o.getID()===t.metadata.pluginID?(e.Core._DispatchPluginMessage(o,t),void 0):void 0}),e.Core._dashboardPlugins.forEach(function(o){return o.getID()===t.metadata.pluginID?(e.Core._DispatchPluginMessage(o,t),void 0):void 0})),void 0):(console.error("invalid message "+JSON.stringify(t)),void 0)},t.prototype._DispatchPluginMessage=function(t,o){t.trace("received "+JSON.stringify(o)),o.metadata.side===e.RuntimeSide.Client?t.isReady()?e.Core._DispatchFromClientPluginMessage(t,o):e.Core._RetrySendingRealtimeMessage(t,o):e.Core._DispatchFromDashboardPluginMessage(t,o)},t.prototype._DispatchFromClientPluginMessage=function(e,t){if(t.command&&e.DashboardCommands){var o=e.DashboardCommands[t.command];if(o)return o.call(e,t.data),void 0}e.onRealtimeMessageReceivedFromClientSide(t.data)},t.prototype._DispatchFromDashboardPluginMessage=function(e,t){if(t.command&&e.ClientCommands){var o=e.ClientCommands[t.command];if(o)return o.call(e,t.data),void 0}e.onRealtimeMessageReceivedFromDashboardSide(t.data)},t}();e._Core=t,e.Core=new t}(VORLON||(VORLON={}));